<script src="https://cdn.jsdelivr.net/gh/netizenorg/netnet-standard-library/build/nn.min.js"></script>
<script>
/* global nn */ 
  
const GIF = "bird_2.gif"
const COLOR = "cornsilk"

let multiplier = 0

const createGIF = function(x, y, angle){
  let rotate = angle / (Math.PI*2) * multiplier
  nn.create("img")
    .set({src: GIF})
    .css({
      position: "absolute",
      left: x,
      top: y,
      transform: `rotate(${rotate}deg)`,
      angle: angle
    })
    .addTo("body")
}

const createSlider = function(min, max, start, step, num, func){
  nn.create('input')
    .set({
      type: 'range',
      min: min,
      max: max,
      value: start,
      step: step
    })
    .addTo('body')
    .on('input', (e) => {func(e)})
    .css({
      position: "absolute",
      left: 10,
      bottom: 10 + 20 * num,
      width: nn.width - 20,
      zIndex: 10
    
  })
}

async function setup(){
  nn.get("body").css({backgroundColor: COLOR})
  
  //rotation slider
  createSlider(0, 3600, multiplier, 360, 0, (e) => {
    multiplier = Number(e.target.value)
    nn.getAll("img").forEach((img) => {
      let rotate = img.style.angle / (Math.PI*2) * multiplier
      img.style.transform = `rotate(${rotate}deg)`
    })
  })
  
  /*createSlider(0, 3600, multiplier, 360, 1, (e) => {
    multiplier = Number(e.target.value)
    nn.getAll("img").forEach((img) => {
      let rotate = img.style.angle / (Math.PI*2) * multiplier
      img.style.transform = `rotate(${rotate}deg)`
    })
  })*/
  
  const gif = await nn.loadImage(GIF)
  
  //number of circles
  let num_circles = 4
  for (let j = 0; j < num_circles; j++){
    //denisty of birds in each circle
    let num_birds = 20 * (j+1)
    for (let i = 0; i < num_birds; i++){
      let x = (nn.width - gif.width) / 2 
      let y = (nn.height - gif.height) / 2 
      let radius = Math.min(x, y) * ((j+1)/num_circles)
      let angle = (2*Math.PI)/num_birds*i
      x += Math.cos(angle) * radius
      y += Math.sin(angle) * radius
      createGIF(x, y, angle)
    }
  }
}
  
nn.on("load", setup)
  
</script>